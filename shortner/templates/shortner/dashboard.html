{% extends 'myapp/base.html' %}
{% load static %}

{% block title %}Dashboard - URL Shortener{% endblock %}

{% block body %}
    <!-- User Profile Header -->
    {% include 'shortner/cover.html' %}

    <div class="dashboard-layout-wrapper">
    <div class="dashboard-layout">
        <!-- Sidebar Navigation -->
        {% include 'shortner/sidebar.html' %}
        
        <!-- Main Content Area (Scrollable) -->
        <main class="main-content">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <h1>Welcome back, {{ user.username }}!</h1>
                <p>Here's an overview of your URL shortening activity and performance metrics.</p>
            </div>

            <!-- Quick Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">üîó</div>
                        <div class="stat-info">
                            <div class="stat-number">{{total_urls_of_user}}</div>
                            <div class="stat-label">Total URLs</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">üëÜ</div>
                        <div class="stat-info">
                            <div class="stat-number">{{total_clicks_of_user}}</div>
                            <div class="stat-label">Total Clicks</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-info">
                            <div class="stat-number">{{total_active_urls}}</div>
                            <div class="stat-label">Active URLs</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-info">
                            <div class="stat-number">{{total_expired_urls}}</div>
                            <div class="stat-label">Expired URLs</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <a href="{% url 'shortner:create_url' %}" class="btn btn-primary">
                    <span>‚ûï</span>
                    <span>Create New URL</span>
                </a>
                
            </div>

            <!-- Recent URLs Section -->
            <div class="section-card">
                <div class="section-header">
                    <h2>Recent URLs</h2>
                    <a href="#" class="view-all">View All</a>
                </div>
                
                <div class="urls-list">
                    {% if short_urls %}
                        {% for item in short_urls %}
                        <div class="url-item">
                            <div class="url-main">
                                <div class="url-info">
                                    <div class="url-original">{{ item.original_url|truncatechars:60 }}</div>
                                    <div class="url-details">
                                        <span class="url-short">{{ item.short_code }}</span>
                                        <span class="url-clicks">{{ item.total_clicks }} clicks</span>
                                        <span class="url-date">{{ item.created_at|date:"M d, Y" }}</span>
                                    </div>
                                </div>
                                <div class="url-actions">
                                    <button class="btn-sm">Copy</button>
                                    <button class="btn-icon" onclick="showQRCode('{{ item.short_code }}')" title="QR Code">
          QR Code
        </button>
                                    <a href="{% url 'shortner:edit_url' item.id %}" class="btn-sm">Edit</a>
                                    <form method="post" action="{% url 'shortner:delete_url' item.id %}" style="display: inline;">
                                        {% csrf_token %}
                                        <button type="submit" class="btn-sm btn-danger" onclick="return confirm('Delete this URL?')">Delete</button>
                                    </form>
                                </div>
                            
                            
                        
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-icon">üîó</div>
                            <h3>No URLs Created Yet</h3>
                            <p>Get started by creating your first shortened URL</p>
                            <a href="{% url 'shortner:create_url' %}" class="btn btn-primary">Create Your First URL</a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Recent Activity -->
            
        </main>
    </div>
</div>
{% include 'shortner/qr_modal.html' %}
{% endblock %}
{% block scripts %}
   <script src="{% static 'js/modal.js' %}"></script>
{% endblock %}